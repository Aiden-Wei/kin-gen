This is the readme file of the TASTE-Integration tool.

The purpose of this program is to generate some glue code and scripts to
facilitate the integration of the C code generated by the ilk-compiler into a
TASTE-based application.

# Usage

## Prerequisites

A valid `Lua` interpreter (`Lua5.2` -- suggested, `Lua5.3` or `Luajit`),
and the `luarocks` tool are required. Please install them from your package
manager (or from sources). Example installation tested on Ubuntu 16.04:

1. Install Lua 5.2 and liblua5.2-dev
```
sudo apt-get install lua5.2 liblua5.2-dev
```

2. Download and install luarocks (from https://luarocks.org/ or using wget):
```
wget http://luarocks.github.io/luarocks/releases/luarocks-2.4.4.tar.gz
tar zxvf luarocks-2.4.4.tar.gz
cd luarocks-2.4.4/
./configure --lua-version=5.2
make build
sudo make install
cd ..
```

  (**NOTE**: getting luarocks using "apt-get install", instead, results in a
   version not compatible with Lua 5.2, on Ubuntu 16.04 as of 14 Jun 2018)


3. Install dependencies using luarocks:
```
cd luarocks
luarocks install --local lua-common-tools-0.1-2.rockspec
```

4. Load luarocks paths (always execute before running the program)
```
eval `luarocks path`
```


## Running the tool

First issue this command in your shell:

```
eval `luarocks path`
```

And then you can run the actual tool:

```
./GenerateTasteBlock.lua
```

The program expects two configuration files in the same directory, `config.yml`
and `metadata.yml`. The latter can be automatically generated by the
ilk-compiler, using the undocumented option `--generate-metadata`; this file
contains information about the solvers, necessary to generate the appropriate
glue code for TASTE. `config.yaml`, instead, should be manually edited to select,
possibly, a subset of solvers, and configure various names related to the
C code generated by the ilk-compiler.

